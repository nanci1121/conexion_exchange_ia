<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email AI - Dashboard de Control</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>

<body class="dark-theme">
    <div class="glass-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon"></div>
                <h1>Email<span>AI</span></h1>
            </div>
            <nav>
                <a href="#" class="active"><i class="icon-dashboard"></i> Dashboard</a>
                <a href="#"><i class="icon-mail"></i> Correos</a>
                <a href="#"><i class="icon-brain"></i> Conocimiento</a>
                <a href="#"><i class="icon-settings"></i> Ajustes</a>
            </nav>
            <div class="status-badge">
                <div class="pulse-indicator" id="main-status-dot"></div>
                <span id="main-status-text">Sistema Activo</span>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="content">
            <header>
                <div class="header-info">
                    <h2>Panel de Control</h2>
                    <p>MonitorizaciÃ³n en tiempo real del asistente inteligente.</p>
                </div>
                <div class="user-profile">
                    <span class="v-avatar">V</span>
                    <span class="username">Mavipi</span>
                </div>
            </header>

            <!-- Stats Grid -->
            <section class="stats-grid">
                <div class="stat-card glass">
                    <div class="stat-icon blue">ðŸ“¬</div>
                    <div class="stat-data">
                        <h3 id="stat-emails">0</h3>
                        <p>Correos Procesados</p>
                    </div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon purple">ðŸ§ </div>
                    <div class="stat-data">
                        <h3 id="stat-llm">Activo</h3>
                        <p>Estado LLM (TinyLlama)</p>
                    </div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon green">âš¡</div>
                    <div class="stat-data">
                        <h3 id="stat-latency">-- ms</h3>
                        <p>Latencia Media</p>
                    </div>
                </div>
                <div class="stat-card glass">
                    <div class="stat-icon orange">ðŸ”‹</div>
                    <div class="stat-data">
                        <h3 id="stat-exchange">Conectado</h3>
                        <p>Exchange (HUAYI)</p>
                    </div>
                </div>
            </section>

            <!-- Active Focus Section -->
            <section id="focus-section" class="glass"
                style="display: none; margin-bottom: 30px; padding: 20px; border-left: 4px solid var(--accent-purple); animation: slideIn 0.5s ease-out;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                    <div>
                        <span class="status-label warning"
                            style="margin-bottom: 10px; display: inline-block;">PROCESANDO AHORA</span>
                        <h3 id="focus-subject" style="font-size: 20px; margin-bottom: 5px;">-</h3>
                        <p id="focus-sender" style="color: var(--text-dim); font-size: 14px;">-</p>
                    </div>
                    <div class="processing-loader"></div>
                </div>
            </section>

            <!-- Live Feed -->
            <section class="live-feed glass">
                <div class="section-header">
                    <h3>Actividad Reciente</h3>
                    <span class="live-tag">LIVE</span>
                </div>
                <div class="feed-table-container">
                    <table id="emails-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Remitente</th>
                                <th>Asunto</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="emails-body">
                            <tr>
                                <td colspan="4" class="empty-msg">Selecciona "Correos" para ver tu bandeja.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pagination Controls -->
                <div class="pagination-container"
                    style="display:flex; justify-content:center; gap:20px; margin-top:20px;">
                    <button id="prev-page" class="btn btn-secondary" onclick="changePage(-1)">Anterior</button>
                    <span id="page-info" style="align-self:center; color:var(--text-dim);">PÃ¡gina 1</span>
                    <button id="next-page" class="btn btn-secondary" onclick="changePage(1)">Siguiente</button>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal de Detalle de Correo -->
    <div id="email-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-subject">Asunto del Correo</h3>
                <p id="modal-sender" style="color: var(--text-dim); margin-top:5px; font-size:14px;"></p>
            </div>
            <div id="modal-body"
                style="margin-bottom: 25px; white-space: pre-wrap; font-size: 14px; line-height: 1.6; max-height: 400px; overflow-y: auto; background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; font-family: 'Inter', sans-serif; color: #e0e0e0; border: 1px solid rgba(255,255,255,0.05);">
            </div>

            <div style="border-top: 1px solid var(--glass-border); padding-top: 20px;">
                <div style="display: flex; gap: 15px; align-items: center; margin-bottom: 15px;">
                    <h4 style="color: var(--accent-blue); margin: 0; font-size: 14px;">Idioma:</h4>
                    <select id="language-selector"
                        style="background: rgba(0,0,0,0.3); color: white; border: 1px solid var(--glass-border); border-radius: 6px; padding: 5px 10px; font-size: 13px;">
                        <option value="es">EspaÃ±ol</option>
                        <option value="en">InglÃ©s</option>
                        <option value="both">Ambos (ES + EN)</option>
                    </select>
                </div>

                <h4 style="color: var(--accent-blue); margin-bottom: 8px; font-size: 14px;">Instrucciones para la IA
                    (Prompt):</h4>
                <textarea id="custom-prompt" placeholder="Ej: Dile que sÃ­ pero que solo puedo el martes..."
                    style="width:100%; height:60px; background: rgba(0,0,0,0.2); color: white; border: 1px solid var(--glass-border); border-radius: 8px; padding: 10px; margin-bottom: 15px; resize: none;"></textarea>

                <h4 style="color: var(--accent-purple); margin-bottom: 8px; font-size: 14px;">Respuesta sugerida:</h4>
                <div id="modal-ai-response"
                    style="background: rgba(157, 80, 187, 0.05); padding: 15px; border-radius: 10px; font-style: italic; min-height: 40px; white-space: pre-wrap; font-size: 14px;">
                </div>
            </div>

            <div class="modal-actions" style="flex-wrap: wrap; margin-top: 20px;">
                <button id="btn-generate" class="btn btn-primary" onclick="handleGenerateAI()">Generar con IA</button>
                <button id="btn-save-draft" class="btn btn-secondary" onclick="handleSaveDraft()"
                    style="background: var(--success); color: white; display: none;">Guardar en Borradores</button>
                <button class="btn btn-secondary" onclick="handleMarkRead()">LeÃ­do</button>
                <button class="btn btn-danger" onclick="handleDelete()">Eliminar</button>
                <button class="btn btn-secondary" style="margin-left: auto;" onclick="closeModal()">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Background Decoration -->
    <div class="bg-gradient-orb orb-1"></div>
    <div class="bg-gradient-orb orb-2"></div>

    <script src="/static/script.js"></script>
</body>

</html>